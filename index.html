<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Player DOOH - Debug</title>
<style>
  body {
    margin: 0; background: black; color: white;
    display: flex; justify-content: center; align-items: center;
    height: 100vh; font-family: Arial, sans-serif;
    font-size: 1.5em; text-align: center;
    padding: 1em;
  }
  #conteudo {
    max-width: 90vw; max-height: 90vh;
  }
  video, img {
    max-width: 100%; max-height: 100%;
  }
</style>
</head>
<body>
<div id="conteudo">Carregando...</div>

<script>
const sheetID = "1ZqpsA7H2ZQrAYueHmcdMcndvhfN6a793nBDJcm2dRoY";
const sheetURL = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

async function carregarPlanilha() {
  try {
    const res = await fetch(sheetURL);
    const txt = await res.text();
    const json = JSON.parse(txt.substr(47).slice(0, -2));
    return json.table.rows.map(r => ({
      tipo: r.c[0]?.v?.toLowerCase(),
      conteudo: r.c[1]?.v,
      duracao: Number(r.c[2]?.v),
    }));
  } catch(e) {
    document.getElementById("conteudo").textContent = "Erro ao carregar planilha: " + e;
    return [];
  }
}

async function iniciarPlayer() {
  const conteudoDiv = document.getElementById("conteudo");
  const lista = await carregarPlanilha();
  if (lista.length === 0) {
    conteudoDiv.textContent = "Planilha vazia ou erro ao carregar.";
    return;
  }

  let idx = 0;

  async function mostrarItem() {
    const item = lista[idx];
    conteudoDiv.innerHTML = "";

    if (!item
