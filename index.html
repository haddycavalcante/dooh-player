<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>Player de Vídeos com Crossfade</title>
<style>
  body, html {
    margin: 0; padding: 0;
    height: 100vh;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #container {
    position: relative;
    width: 80vw;
    max-width: 1280px;
    aspect-ratio: 16 / 9;
  }
  video {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
    background: black;
    transition: opacity 1s ease;
    opacity: 0;
    pointer-events: none; /* desabilita interação */
  }
  video.active {
    opacity: 1;
    pointer-events: auto; /* só o ativo responde */
  }
</style>
</head>
<body>

<div id="container">
  <video id="video1" muted playsinline></video>
  <video id="video2" muted playsinline></video>
</div>

<script>
  const videos = [
    "https://raw.githubusercontent.com/haddycavalcante/dooh-player/main/A%20quinta%20onda%20de%20frio%20do%20ano%20vai%20deixar%20os%20pr%C3%B3ximos%20dias%20bastante%20gelad.mp4",
    "https://raw.githubusercontent.com/haddycavalcante/dooh-player/main/E%20eu%20n%C3%A3o%20sou%20nadinha%20diferente.mp4"
  ];

  const video1 = document.getElementById('video1');
  const video2 = document.getElementById('video2');

  let currentIndex = 0;
  let currentVideo = video1;
  let nextVideo = video2;

  // Inicializa o primeiro vídeo
  currentVideo.src = videos[currentIndex];
  currentVideo.classList.add('active');
  currentVideo.play();

  // Função para alternar vídeos com crossfade
  function next() {
    currentIndex = (currentIndex + 1) % videos.length;

    // Prepara o próximo vídeo
    nextVideo.src = videos[currentIndex];
    nextVideo.currentTime = 0;
    nextVideo.classList.add('active');
    nextVideo.play();

    // Faz o crossfade: próximo vídeo aparece, atual some
    currentVideo.classList.remove('active');

    // Depois da transição, pausa o vídeo antigo e troca as referências
    setTimeout(() => {
      currentVideo.pause();

      // troca os players para a próxima rodada
      let temp = currentVideo;
      currentVideo = nextVideo;
      nextVideo = temp;
    }, 1000); // tempo da transição em ms (igual ao CSS)
  }

  // Quando o vídeo atual terminar, troca para o próximo
  currentVideo.addEventListener('ended', next);

  // Para garantir que o evento funcione sempre no vídeo ativo, vamos "atualizar" o listener:
  // A cada troca, removemos do vídeo antigo e adicionamos no atual:
  function setupListeners() {
    video1.removeEventListener('ended', next);
    video2.removeEventListener('ended', next);
    currentVideo.addEventListener('ended', next);
  }

  // Atualiza listeners sempre que troca
  const observer = new MutationObserver(() => {
    setupListeners();
  });
  observer.observe(document.getElementById('container'), { attributes: true, subtree: true, attributeFilter: ['class'] });

  setupListeners();
</script>

</body>
</html>
